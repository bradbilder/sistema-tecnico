<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gerenciamento - T√©cnico</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        header h1 {
            font-size: 24px;
        }

        nav {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        nav button {
            padding: 10px 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        nav button:hover, nav button.active {
            background: white;
            color: #667eea;
        }

        .content {
            padding: 30px 20px;
            min-height: calc(100vh - 150px);
        }

        .section {
            display: none;
        }

        .section.ativo {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .card h3 {
            font-size: 14px;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .card .numero {
            font-size: 36px;
            font-weight: bold;
        }

        .form-group {
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
        }

        label {
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }

        input, select, textarea {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.2);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .form-container {
            background: #f9f9f9;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 4px solid #667eea;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }

        button {
            padding: 12px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            transition: all 0.3s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button.danger {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        button.success {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #ddd;
        }

        tr:hover {
            background: #f9f9f9;
        }

        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }

        .badge.aberto {
            background: #ffd700;
            color: #333;
        }

        .badge.fechado {
            background: #90ee90;
            color: #333;
        }

        .badge.alta {
            background: #ff6b6b;
            color: white;
        }

        .badge.media {
            background: #ffa500;
            color: white;
        }

        .badge.baixa {
            background: #4caf50;
            color: white;
        }

        .badge.agendado {
            background: #87ceeb;
            color: #333;
        }

        .badge.cancelado {
            background: #ccc;
            color: #333;
        }

        .badge.pago {
            background: #90ee90;
            color: #333;
        }

        .badge.pendente {
            background: #ff9800;
            color: white;
        }

        .action-buttons {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 3px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.aberto {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 15px;
        }

        .modal-header h2 {
            margin: 0;
        }

        .fechar {
            font-size: 28px;
            cursor: pointer;
            background: none;
            border: none;
            color: #999;
        }

        .fechar:hover {
            color: #333;
        }

        .alerta {
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            display: none;
        }

        .alerta.sucesso {
            display: block;
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alerta.erro {
            display: block;
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-box {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }

        .stat-box h4 {
            color: #666;
            margin-bottom: 10px;
            font-size: 12px;
            text-transform: uppercase;
        }

        .stat-box .valor {
            font-size: 28px;
            font-weight: bold;
            color: #667eea;
        }

        @media (max-width: 768px) {
            header {
                flex-direction: column;
            }

            header h1 {
                font-size: 20px;
            }

            nav {
                width: 100%;
                justify-content: space-between;
            }

            nav button {
                flex: 1;
                padding: 8px 12px;
                font-size: 12px;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            table {
                font-size: 12px;
            }

            th, td {
                padding: 10px 5px;
            }

            .action-buttons {
                flex-direction: column;
            }

            .btn-small {
                width: 100%;
            }
        }

        .filtro-container {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîß SISTEMA DE GERENCIAMENTO T√âCNICO</h1>
            <nav>
                <button class="nav-btn ativo" data-secao="dashboard">üìä Dashboard</button>
                <button class="nav-btn" data-secao="clientes">üë• Clientes</button>
                <button class="nav-btn" data-secao="chamados">üé´ Chamados</button>
                <button class="nav-btn" data-secao="agendamentos">üìÖ Agendamentos</button>
                <button class="nav-btn" data-secao="servicos">üíº Servi√ßos</button>
                <button class="nav-btn" data-secao="pagamentos">üí≥ Pagamentos</button>
                <button class="nav-btn" data-secao="manutencoes">üîß Manuten√ß√µes</button>
                <button class="nav-btn" data-secao="estoque">üì¶ Estoque</button>
            </nav>
        </header>

        <div class="content">
            <!-- ===== DASHBOARD ===== -->
            <section id="dashboard" class="section ativo">
                <h2>üìä Dashboard</h2>
                <div class="dashboard-grid">
                    <div class="card">
                        <h3>üë• Total de Clientes</h3>
                        <div class="numero" id="totalClientes">0</div>
                    </div>
                    <div class="card">
                        <h3>üé´ Chamados Abertos</h3>
                        <div class="numero" id="chamadosAbertos">0</div>
                    </div>
                    <div class="card">
                        <h3>üìÖ Agendamentos</h3>
                        <div class="numero" id="agendamentosProximos">0</div>
                    </div>
                    <div class="card">
                        <h3>üí∞ Pendente</h3>
                        <div class="numero" id="pagamentosPendentes">R$ 0</div>
                    </div>
                    <div class="card">
                        <h3>üíµ Receita</h3>
                        <div class="numero" id="receitaTotal">R$ 0</div>
                    </div>
                </div>

                <h3 style="margin-top: 30px;">üìà Resumo R√°pido</h3>
                <div class="stats">
                    <div class="stat-box">
                        <h4>Clientes Ativos</h4>
                        <div class="valor" id="stat-clientes">0</div>
                    </div>
                    <div class="stat-box">
                        <h4>Chamados Hoje</h4>
                        <div class="valor" id="stat-chamados">0</div>
                    </div>
                    <div class="stat-box">
                        <h4>Manuten√ß√µes Programadas</h4>
                        <div class="valor" id="stat-manutencoes">0</div>
                    </div>
                </div>
            </section>

            <!-- ===== CLIENTES ===== -->
            <section id="clientes" class="section">
                <h2>üë• Gerenciar Clientes</h2>

                <div class="form-container">
                    <h3>Novo Cliente</h3>
                    <form id="formCliente">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Nome *</label>
                                <input type="text" id="cliente_nome" required>
                            </div>
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="cliente_email">
                            </div>
                            <div class="form-group">
                                <label>Telefone</label>
                                <input type="tel" id="cliente_telefone">
                            </div>
                            <div class="form-group">
                                <label>Empresa</label>
                                <input type="text" id="cliente_empresa">
                            </div>
                            <div class="form-group">
                                <label>Endere√ßo</label>
                                <input type="text" id="cliente_endereco">
                            </div>
                        </div>
                        <button type="submit">‚ûï Adicionar Cliente</button>
                    </form>
                </div>

                <div id="alertaCliente" class="alerta"></div>

                <h3>Clientes Cadastrados</h3>
                <div class="table-container">
                    <table id="tabelaClientes">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Email</th>
                                <th>Telefone</th>
                                <th>Empresa</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- ===== CHAMADOS ===== -->
            <section id="chamados" class="section">
                <h2>üé´ Gerenciar Chamados</h2>

                <div class="form-container">
                    <h3>Novo Chamado</h3>
                    <form id="formChamado">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Cliente *</label>
                                <select id="chamado_cliente" required>
                                    <option value="">Selecione...</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>T√≠tulo *</label>
                                <input type="text" id="chamado_titulo" required>
                            </div>
                            <div class="form-group">
                                <label>Prioridade</label>
                                <select id="chamado_prioridade">
                                    <option value="baixa">Baixa</option>
                                    <option value="m√©dia" selected>M√©dia</option>
                                    <option value="alta">Alta</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Descri√ß√£o</label>
                            <textarea id="chamado_descricao"></textarea>
                        </div>
                        <button type="submit">üé´ Abrir Chamado</button>
                    </form>
                </div>

                <div id="alertaChamado" class="alerta"></div>

                <h3>Chamados Ativos</h3>
                <div class="table-container">
                    <table id="tabelaChamados">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Cliente</th>
                                <th>T√≠tulo</th>
                                <th>Prioridade</th>
                                <th>Status</th>
                                <th>Abertura</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- ===== AGENDAMENTOS ===== -->
            <section id="agendamentos" class="section">
                <h2>üìÖ Gerenciar Agendamentos</h2>

                <div class="form-container">
                    <h3>Novo Agendamento</h3>
                    <form id="formAgendamento">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Cliente *</label>
                                <select id="agenda_cliente" required>
                                    <option value="">Selecione...</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Servi√ßo</label>
                                <select id="agenda_servico">
                                    <option value="">Selecione...</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Data *</label>
                                <input type="date" id="agenda_data" required>
                            </div>
                            <div class="form-group">
                                <label>Hora *</label>
                                <input type="time" id="agenda_hora" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Notas</label>
                            <textarea id="agenda_notas"></textarea>
                        </div>
                        <button type="submit">üìÖ Agendar</button>
                    </form>
                </div>

                <div id="alertaAgenda" class="alerta"></div>

                <h3>Pr√≥ximos Agendamentos</h3>
                <div class="table-container">
                    <table id="tabelaAgendamentos">
                        <thead>
                            <tr>
                                <th>Cliente</th>
                                <th>Servi√ßo</th>
                                <th>Data</th>
                                <th>Hora</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- ===== SERVI√áOS ===== -->
            <section id="servicos" class="section">
                <h2>üíº Gerenciar Servi√ßos</h2>

                <div class="form-container">
                    <h3>Novo Servi√ßo</h3>
                    <form id="formServico">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Nome *</label>
                                <input type="text" id="servico_nome" required>
                            </div>
                            <div class="form-group">
                                <label>Categoria</label>
                                <input type="text" id="servico_categoria" placeholder="ex: Manuten√ß√£o">
                            </div>
                            <div class="form-group">
                                <label>Pre√ßo (R$)</label>
                                <input type="number" id="servico_preco" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Tempo M√©dio (minutos)</label>
                                <input type="number" id="servico_tempo">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Descri√ß√£o</label>
                            <textarea id="servico_descricao"></textarea>
                        </div>
                        <button type="submit">‚ûï Adicionar Servi√ßo</button>
                    </form>
                </div>

                <div id="alertaServico" class="alerta"></div>

                <h3>Servi√ßos Cadastrados</h3>
                <div class="table-container">
                    <table id="tabelaServicos">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Categoria</th>
                                <th>Pre√ßo</th>
                                <th>Tempo M√©dio</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- ===== PAGAMENTOS ===== -->
            <section id="pagamentos" class="section">
                <h2>üí≥ Gerenciar Pagamentos</h2>

                <div class="form-container">
                    <h3>Registrar Pagamento</h3>
                    <form id="formPagamento">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Cliente *</label>
                                <select id="pagto_cliente" required>
                                    <option value="">Selecione...</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Valor (R$) *</label>
                                <input type="number" id="pagto_valor" step="0.01" required>
                            </div>
                            <div class="form-group">
                                <label>M√©todo</label>
                                <select id="pagto_metodo">
                                    <option value="dinheiro">Dinheiro</option>
                                    <option value="cartao">Cart√£o</option>
                                    <option value="transferencia">Transfer√™ncia</option>
                                    <option value="pix">PIX</option>
                                    <option value="boleto">Boleto</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Status</label>
                                <select id="pagto_status">
                                    <option value="pendente">Pendente</option>
                                    <option value="pago">Pago</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Descri√ß√£o</label>
                            <textarea id="pagto_descricao"></textarea>
                        </div>
                        <button type="submit">üí≥ Registrar Pagamento</button>
                    </form>
                </div>

                <div id="alertaPagto" class="alerta"></div>

                <h3>Hist√≥rico de Pagamentos</h3>
                <div class="table-container">
                    <table id="tabelaPagamentos">
                        <thead>
                            <tr>
                                <th>Cliente</th>
                                <th>Valor</th>
                                <th>M√©todo</th>
                                <th>Data</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- ===== MANUTEN√á√ïES ===== -->
            <section id="manutencoes" class="section">
                <h2>üîß Gerenciar Manuten√ß√µes</h2>

                <div class="form-container">
                    <h3>Agendar Manuten√ß√£o</h3>
                    <form id="formManutencao">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Cliente *</label>
                                <select id="manut_cliente" required>
                                    <option value="">Selecione...</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Tipo</label>
                                <select id="manut_tipo">
                                    <option value="preventiva">Preventiva</option>
                                    <option value="corretiva">Corretiva</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Data *</label>
                                <input type="date" id="manut_data" required>
                            </div>
                            <div class="form-group">
                                <label>Frequ√™ncia</label>
                                <select id="manut_frequencia">
                                    <option value="mensal">Mensal</option>
                                    <option value="trimestral">Trimestral</option>
                                    <option value="semestral">Semestral</option>
                                    <option value="anual">Anual</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Checklist (separados por v√≠rgula)</label>
                            <textarea id="manut_checklist" placeholder="Verificar temperatura, Limpeza, Backup..."></textarea>
                        </div>
                        <button type="submit">üîß Agendar Manuten√ß√£o</button>
                    </form>
                </div>

                <div id="alertaManut" class="alerta"></div>

                <h3>Manuten√ß√µes Programadas</h3>
                <div class="table-container">
                    <table id="tabelaManutencoes">
                        <thead>
                            <tr>
                                <th>Cliente</th>
                                <th>Tipo</th>
                                <th>Pr√≥xima Execu√ß√£o</th>
                                <th>Frequ√™ncia</th>
                                <th>Status</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>

            <!-- ===== ESTOQUE ===== -->
            <section id="estoque" class="section">
                <h2>üì¶ Gerenciar Estoque</h2>

                <div class="form-container">
                    <h3>Adicionar ao Estoque</h3>
                    <form id="formEstoque">
                        <div class="form-grid">
                            <div class="form-group">
                                <label>Nome do Item *</label>
                                <input type="text" id="estoque_nome" required>
                            </div>
                            <div class="form-group">
                                <label>Categoria</label>
                                <input type="text" id="estoque_categoria" placeholder="ex: Cabo, Monitor...">
                            </div>
                            <div class="form-group">
                                <label>Quantidade *</label>
                                <input type="number" id="estoque_quantidade" required>
                            </div>
                            <div class="form-group">
                                <label>Pre√ßo Unit√°rio (R$)</label>
                                <input type="number" id="estoque_preco" step="0.01">
                            </div>
                            <div class="form-group">
                                <label>Fornecedor</label>
                                <input type="text" id="estoque_fornecedor">
                            </div>
                            <div class="form-group">
                                <label>N√≠vel M√≠nimo</label>
                                <input type="number" id="estoque_minimo">
                            </div>
                        </div>
                        <button type="submit">üì¶ Adicionar Item</button>
                    </form>
                </div>

                <div id="alertaEstoque" class="alerta"></div>

                <h3>Itens em Estoque</h3>
                <div class="table-container">
                    <table id="tabelaEstoque">
                        <thead>
                            <tr>
                                <th>Nome</th>
                                <th>Categoria</th>
                                <th>Quantidade</th>
                                <th>Pre√ßo Unit.</th>
                                <th>Fornecedor</th>
                                <th>A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </section>
        </div>
    </div>

    <script>
        // ===== CONFIGURA√á√ÉO =====
        const API_URL = 'http://localhost:3000/api'; // Mude para URL do servidor quando deployado

        // ===== FUN√á√ïES GERAIS =====
        function mostrarAlerta(elementId, mensagem, tipo) {
            const alerta = document.getElementById(elementId);
            alerta.textContent = mensagem;
            alerta.className = `alerta ${tipo}`;
            setTimeout(() => alerta.className = 'alerta', 5000);
        }

        function trocarSecao(secao) {
            document.querySelectorAll('.section').forEach(el => el.classList.remove('ativo'));
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('ativo'));
            document.getElementById(secao).classList.add('ativo');
            event.target.classList.add('ativo');
            
            // Carregar dados ao trocar
            if (secao === 'clientes') carregarClientes();
            if (secao === 'chamados') carregarChamados();
            if (secao === 'agendamentos') carregarAgendamentos();
            if (secao === 'servicos') carregarServicos();
            if (secao === 'pagamentos') carregarPagamentos();
            if (secao === 'manutencoes') carregarManutencoes();
            if (secao === 'estoque') carregarEstoque();
        }

        // ===== CARREGAMENTO DE DADOS =====
        async function carregarDashboard() {
            try {
                const resp = await fetch(`${API_URL}/dashboard`);
                const dados = await resp.json();

                document.getElementById('totalClientes').textContent = dados.totalClientes;
                document.getElementById('chamadosAbertos').textContent = dados.chamadosAbertos;
                document.getElementById('agendamentosProximos').textContent = dados.agendamentosProximos;
                document.getElementById('pagamentosPendentes').textContent = 'R$ ' + formatarMoeda(dados.pagamentosPendentes);
                document.getElementById('receitaTotal').textContent = 'R$ ' + formatarMoeda(dados.receitaTotal);
            } catch (err) {
                console.error('Erro ao carregar dashboard:', err);
            }
        }

        async function carregarClientes() {
            try {
                const resp = await fetch(`${API_URL}/clientes`);
                const clientes = await resp.json();

                const tbody = document.querySelector('#tabelaClientes tbody');
                tbody.innerHTML = '';

                clientes.forEach(c => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${c.nome}</td>
                        <td>${c.email || '-'}</td>
                        <td>${c.telefone || '-'}</td>
                        <td>${c.empresa || '-'}</td>
                        <td><span class="badge ${c.status}">${c.status}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-small success" onclick="editarCliente('${c.id}')">‚úèÔ∏è Editar</button>
                                <button class="btn-small danger" onclick="deletarCliente('${c.id}')">üóëÔ∏è Deletar</button>
                            </div>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });

                // Preencher select de clientes
                const select = document.getElementById('chamado_cliente');
                select.innerHTML = '<option value="">Selecione...</option>';
                clientes.forEach(c => {
                    const option = document.createElement('option');
                    option.value = c.id;
                    option.textContent = c.nome;
                    select.appendChild(option);
                });

                // Select agendamentos
                const selectAgenda = document.getElementById('agenda_cliente');
                selectAgenda.innerHTML = '<option value="">Selecione...</option>';
                clientes.forEach(c => {
                    const option = document.createElement('option');
                    option.value = c.id;
                    option.textContent = c.nome;
                    selectAgenda.appendChild(option);
                });

                // Select pagamentos
                const selectPagto = document.getElementById('pagto_cliente');
                selectPagto.innerHTML = '<option value="">Selecione...</option>';
                clientes.forEach(c => {
                    const option = document.createElement('option');
                    option.value = c.id;
                    option.textContent = c.nome;
                    selectPagto.appendChild(option);
                });

                // Select manuten√ß√£o
                const selectManut = document.getElementById('manut_cliente');
                selectManut.innerHTML = '<option value="">Selecione...</option>';
                clientes.forEach(c => {
                    const option = document.createElement('option');
                    option.value = c.id;
                    option.textContent = c.nome;
                    selectManut.appendChild(option);
                });
            } catch (err) {
                mostrarAlerta('alertaCliente', 'Erro ao carregar clientes', 'erro');
            }
        }

        async function carregarChamados() {
            try {
                const resp = await fetch(`${API_URL}/chamados`);
                const chamados = await resp.json();

                const tbody = document.querySelector('#tabelaChamados tbody');
                tbody.innerHTML = '';

                chamados.forEach(ch => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${ch.id.substring(0, 8)}</td>
                        <td>${ch.cliente_nome}</td>
                        <td>${ch.titulo}</td>
                        <td><span class="badge ${ch.prioridade}">${ch.prioridade}</span></td>
                        <td><span class="badge ${ch.status}">${ch.status}</span></td>
                        <td>${formatarData(ch.data_abertura)}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-small success" onclick="editarChamado('${ch.id}')">‚úèÔ∏è Editar</button>
                            </div>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });
            } catch (err) {
                mostrarAlerta('alertaChamado', 'Erro ao carregar chamados', 'erro');
            }
        }

        async function carregarAgendamentos() {
            try {
                const resp = await fetch(`${API_URL}/agendamentos`);
                const agendamentos = await resp.json();

                const tbody = document.querySelector('#tabelaAgendamentos tbody');
                tbody.innerHTML = '';

                agendamentos.forEach(a => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${a.cliente_nome}</td>
                        <td>${a.servico_nome || '-'}</td>
                        <td>${formatarData(a.data_agendada)}</td>
                        <td>${a.hora}</td>
                        <td><span class="badge ${a.status}">${a.status}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-small success" onclick="editarAgendamento('${a.id}')">‚úèÔ∏è Editar</button>
                            </div>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });
            } catch (err) {
                mostrarAlerta('alertaAgenda', 'Erro ao carregar agendamentos', 'erro');
            }
        }

        async function carregarServicos() {
            try {
                const resp = await fetch(`${API_URL}/servicos`);
                const servicos = await resp.json();

                const tbody = document.querySelector('#tabelaServicos tbody');
                tbody.innerHTML = '';

                servicos.forEach(s => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${s.nome}</td>
                        <td>${s.categoria || '-'}</td>
                        <td>R$ ${formatarMoeda(s.preco)}</td>
                        <td>${s.tempo_medio} min</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-small danger" onclick="deletarServico('${s.id}')">üóëÔ∏è Deletar</button>
                            </div>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });

                // Preencher select
                const select = document.getElementById('agenda_servico');
                select.innerHTML = '<option value="">Selecione...</option>';
                servicos.forEach(s => {
                    const option = document.createElement('option');
                    option.value = s.id;
                    option.textContent = s.nome;
                    select.appendChild(option);
                });
            } catch (err) {
                mostrarAlerta('alertaServico', 'Erro ao carregar servi√ßos', 'erro');
            }
        }

        async function carregarPagamentos() {
            try {
                const resp = await fetch(`${API_URL}/pagamentos`);
                const pagamentos = await resp.json();

                const tbody = document.querySelector('#tabelaPagamentos tbody');
                tbody.innerHTML = '';

                pagamentos.forEach(p => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${p.cliente_nome}</td>
                        <td>R$ ${formatarMoeda(p.valor)}</td>
                        <td>${p.metodo}</td>
                        <td>${formatarData(p.data_pagamento)}</td>
                        <td><span class="badge ${p.status}">${p.status}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-small success" onclick="atualizarStatusPagamento('${p.id}')">‚úÖ Marcar Pago</button>
                            </div>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });
            } catch (err) {
                mostrarAlerta('alertaPagto', 'Erro ao carregar pagamentos', 'erro');
            }
        }

        async function carregarManutencoes() {
            try {
                const resp = await fetch(`${API_URL}/manutencoes`);
                const manutencoes = await resp.json();

                const tbody = document.querySelector('#tabelaManutencoes tbody');
                tbody.innerHTML = '';

                manutencoes.forEach(m => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${m.cliente_nome}</td>
                        <td>${m.tipo}</td>
                        <td>${formatarData(m.proxima_execucao)}</td>
                        <td>${m.frequencia}</td>
                        <td><span class="badge ${m.status}">${m.status}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-small success" onclick="marcarExecutado('${m.id}')">‚úÖ Executado</button>
                            </div>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });
            } catch (err) {
                mostrarAlerta('alertaManut', 'Erro ao carregar manuten√ß√µes', 'erro');
            }
        }

        async function carregarEstoque() {
            try {
                const resp = await fetch(`${API_URL}/estoque`);
                const itens = await resp.json();

                const tbody = document.querySelector('#tabelaEstoque tbody');
                tbody.innerHTML = '';

                itens.forEach(item => {
                    const bgcolor = item.quantidade <= item.nivel_minimo ? '#ffe0e0' : '';
                    const tr = document.createElement('tr');
                    tr.style.backgroundColor = bgcolor;
                    tr.innerHTML = `
                        <td>${item.nome}</td>
                        <td>${item.categoria || '-'}</td>
                        <td>${item.quantidade}</td>
                        <td>R$ ${formatarMoeda(item.preco_unitario)}</td>
                        <td>${item.fornecedor || '-'}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-small danger" onclick="deletarEstoque('${item.id}')">üóëÔ∏è Deletar</button>
                            </div>
                        </td>
                    `;
                    tbody.appendChild(tr);
                });
            } catch (err) {
                mostrarAlerta('alertaEstoque', 'Erro ao carregar estoque', 'erro');
            }
        }

        // ===== FORMUL√ÅRIOS =====
        document.getElementById('formCliente').addEventListener('submit', async (e) => {
            e.preventDefault();
            try {
                const resp = await fetch(`${API_URL}/clientes`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        nome: document.getElementById('cliente_nome').value,
                        email: document.getElementById('cliente_email').value,
                        telefone: document.getElementById('cliente_telefone').value,
                        empresa: document.getElementById('cliente_empresa').value,
                        endereco: document.getElementById('cliente_endereco').value
                    })
                });
                const data = await resp.json();
                if (data.sucesso) {
                    mostrarAlerta('alertaCliente', '‚úÖ Cliente cadastrado com sucesso!', 'sucesso');
                    e.target.reset();
                    carregarClientes();
                }
            } catch (err) {
                mostrarAlerta('alertaCliente', '‚ùå Erro ao cadastrar cliente', 'erro');
            }
        });

        document.getElementById('formChamado').addEventListener('submit', async (e) => {
            e.preventDefault();
            try {
                const resp = await fetch(`${API_URL}/chamados`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        cliente_id: document.getElementById('chamado_cliente').value,
                        titulo: document.getElementById('chamado_titulo').value,
                        descricao: document.getElementById('chamado_descricao').value,
                        prioridade: document.getElementById('chamado_prioridade').value,
                        tecnico: 'Voc√™'
                    })
                });
                const data = await resp.json();
                if (data.sucesso) {
                    mostrarAlerta('alertaChamado', '‚úÖ Chamado aberto com sucesso!', 'sucesso');
                    e.target.reset();
                    carregarChamados();
                }
            } catch (err) {
                mostrarAlerta('alertaChamado', '‚ùå Erro ao abrir chamado', 'erro');
            }
        });

        document.getElementById('formAgendamento').addEventListener('submit', async (e) => {
            e.preventDefault();
            try {
                const resp = await fetch(`${API_URL}/agendamentos`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        cliente_id: document.getElementById('agenda_cliente').value,
                        servico_id: document.getElementById('agenda_servico').value || null,
                        data_agendada: document.getElementById('agenda_data').value,
                        hora: document.getElementById('agenda_hora').value,
                        notas: document.getElementById('agenda_notas').value
                    })
                });
                const data = await resp.json();
                if (data.sucesso) {
                    mostrarAlerta('alertaAgenda', '‚úÖ Agendamento realizado!', 'sucesso');
                    e.target.reset();
                    carregarAgendamentos();
                }
            } catch (err) {
                mostrarAlerta('alertaAgenda', '‚ùå Erro ao agendar', 'erro');
            }
        });

        document.getElementById('formServico').addEventListener('submit', async (e) => {
            e.preventDefault();
            try {
                const resp = await fetch(`${API_URL}/servicos`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        nome: document.getElementById('servico_nome').value,
                        categoria: document.getElementById('servico_categoria').value,
                        preco: parseFloat(document.getElementById('servico_preco').value) || 0,
                        tempo_medio: parseInt(document.getElementById('servico_tempo').value) || 0,
                        descricao: document.getElementById('servico_descricao').value
                    })
                });
                const data = await resp.json();
                if (data.sucesso) {
                    mostrarAlerta('alertaServico', '‚úÖ Servi√ßo cadastrado!', 'sucesso');
                    e.target.reset();
                    carregarServicos();
                }
            } catch (err) {
                mostrarAlerta('alertaServico', '‚ùå Erro ao cadastrar servi√ßo', 'erro');
            }
        });

        document.getElementById('formPagamento').addEventListener('submit', async (e) => {
            e.preventDefault();
            try {
                const resp = await fetch(`${API_URL}/pagamentos`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        cliente_id: document.getElementById('pagto_cliente').value,
                        valor: parseFloat(document.getElementById('pagto_valor').value),
                        metodo: document.getElementById('pagto_metodo').value,
                        descricao: document.getElementById('pagto_descricao').value
                    })
                });
                const data = await resp.json();
                if (data.sucesso) {
                    mostrarAlerta('alertaPagto', '‚úÖ Pagamento registrado!', 'sucesso');
                    e.target.reset();
                    carregarPagamentos();
                    carregarDashboard();
                }
            } catch (err) {
                mostrarAlerta('alertaPagto', '‚ùå Erro ao registrar pagamento', 'erro');
            }
        });

        document.getElementById('formManutencao').addEventListener('submit', async (e) => {
            e.preventDefault();
            try {
                const resp = await fetch(`${API_URL}/manutencoes`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        cliente_id: document.getElementById('manut_cliente').value,
                        tipo: document.getElementById('manut_tipo').value,
                        data_agendada: document.getElementById('manut_data').value,
                        frequencia: document.getElementById('manut_frequencia').value,
                        checklist: document.getElementById('manut_checklist').value
                    })
                });
                const data = await resp.json();
                if (data.sucesso) {
                    mostrarAlerta('alertaManut', '‚úÖ Manuten√ß√£o agendada!', 'sucesso');
                    e.target.reset();
                    carregarManutencoes();
                }
            } catch (err) {
                mostrarAlerta('alertaManut', '‚ùå Erro ao agendar manuten√ß√£o', 'erro');
            }
        });

        document.getElementById('formEstoque').addEventListener('submit', async (e) => {
            e.preventDefault();
            try {
                const resp = await fetch(`${API_URL}/estoque`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        nome: document.getElementById('estoque_nome').value,
                        categoria: document.getElementById('estoque_categoria').value,
                        quantidade: parseInt(document.getElementById('estoque_quantidade').value),
                        preco_unitario: parseFloat(document.getElementById('estoque_preco').value) || 0,
                        fornecedor: document.getElementById('estoque_fornecedor').value,
                        nivel_minimo: parseInt(document.getElementById('estoque_minimo').value) || 5
                    })
                });
                const data = await resp.json();
                if (data.sucesso) {
                    mostrarAlerta('alertaEstoque', '‚úÖ Item adicionado ao estoque!', 'sucesso');
                    e.target.reset();
                    carregarEstoque();
                }
            } catch (err) {
                mostrarAlerta('alertaEstoque', '‚ùå Erro ao adicionar item', 'erro');
            }
        });

        // ===== FUN√á√ïES DE A√á√ÉO =====
        async function deletarCliente(id) {
            if (!confirm('Deseja realmente deletar este cliente?')) return;
            try {
                await fetch(`${API_URL}/clientes/${id}`, { method: 'DELETE' });
                mostrarAlerta('alertaCliente', '‚úÖ Cliente deletado!', 'sucesso');
                carregarClientes();
            } catch (err) {
                mostrarAlerta('alertaCliente', '‚ùå Erro ao deletar', 'erro');
            }
        }

        async function deletarServico(id) {
            if (!confirm('Deseja deletar este servi√ßo?')) return;
            alert('Fun√ß√£o deletarServico n√£o implementada no backend');
        }

        async function deletarEstoque(id) {
            if (!confirm('Deseja deletar este item?')) return;
            alert('Fun√ß√£o deletarEstoque n√£o implementada no backend');
        }

        async function atualizarStatusPagamento(id) {
            try {
                await fetch(`${API_URL}/pagamentos/${id}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ status: 'pago' })
                });
                mostrarAlerta('alertaPagto', '‚úÖ Pagamento atualizado!', 'sucesso');
                carregarPagamentos();
                carregarDashboard();
            } catch (err) {
                mostrarAlerta('alertaPagto', '‚ùå Erro ao atualizar', 'erro');
            }
        }

        async function marcarExecutado(id) {
            alert('Fun√ß√£o marcarExecutado n√£o implementada');
        }

        function editarCliente(id) {
            alert('Fun√ß√£o editar n√£o implementada');
        }

        function editarChamado(id) {
            alert('Fun√ß√£o editar n√£o implementada');
        }

        function editarAgendamento(id) {
            alert('Fun√ß√£o editar n√£o implementada');
        }

        // ===== UTILIT√ÅRIOS =====
        function formatarMoeda(valor) {
            return parseFloat(valor).toFixed(2).replace('.', ',');
        }

        function formatarData(data) {
            return new Date(data).toLocaleDateString('pt-BR');
        }

        // ===== EVENT LISTENERS =====
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                trocarSecao(e.target.dataset.secao);
            });
        });

        // ===== INICIALIZA√á√ÉO =====
        window.addEventListener('load', () => {
            carregarDashboard();
            carregarClientes();
            setInterval(carregarDashboard, 30000); // Atualizar a cada 30s
        });
    </script>
</body>
</html>